<div id="pricing-hi-raw-list" class="page-layout simple fullwidth" fxLayout="column" fusePerfectScrollbar>

    <!-- CONTENT -->
    <div class="content p-24">

        <form class="mat-card p-24" fxLayout="column" name="form" [formGroup]="form" #formData='ngForm'
            (ngSubmit)="onSearch(formData)">

            <div class="h2 mb-24">Pricing Hi-Raw</div>

            <div fxLayout="row wrap" fxLayoutAlign="start center" fxFlex="1 0 auto">

                <mat-form-field appearance="outline" fxFlex="100" fxFlex.gt-sm="50" class="pl-4">
                    <mat-label>Buyer</mat-label>
                    <mat-select formControlName="buyer">
                        <mat-option [value]="">
                            --All--
                        </mat-option>
                        <mat-option *ngFor="let buyer of buyers" [value]="buyer.id">
                            {{buyer.party_name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" fxFlex="100" fxFlex.gt-sm="50" class="pl-4">
                    <mat-label>Group Factory</mat-label>
                    <mat-select formControlName="groupfactory">
                        <mat-option [value]="">
                            --All--
                        </mat-option>
                        <mat-option *ngFor="let groupfactory of groupfactorys" [value]="groupfactory.id">
                            {{groupfactory.lov1}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

            </div>
            <div fxLayout="row wrap" fxLayoutAlign="start center" fxFlex="1 0 auto">

                <mat-form-field appearance="outline" fxFlex="100" fxFlex.gt-sm="50" class="pr-4">
                    <mat-label>Buyer Contrace No.</mat-label>
                    <input matInput formControlName="buyercontractno">

                </mat-form-field>

                <mat-form-field appearance="outline" fxFlex="100" fxFlex.gt-sm="50" class="pl-4">
                    <mat-label>Contract No.</mat-label>
                    <input matInput formControlName="contarctno">

                </mat-form-field>

            </div>

            <div fxLayout="row wrap" fxLayoutAlign="center center" fxFlex="1 0 auto">
                <button type="submit" mat-raised-button color="accent" class="submit-button" aria-label="LOGIN">
                    SEARCH
                </button>
            </div>


        </form>

        <mat-card class="mt-24 mb-24">
            <!-- <ngx-data-table [data]="data"></ngx-data-table> -->
            <div class="h2 mb-24">Search Results</div>

            <mat-table #table1 *ngIf="dataSource.length > 0" [dataSource]="dataSource" multiTemplateDataRows matSort
                aria-label="Elements">
                <ng-container [matColumnDef]="cols" *ngFor="let cols of displayedColumns; let i = index">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>
                        <span *ngIf="!(i === 0)">
                            {{cols}}
                        </span>
                    </mat-header-cell>
                    <mat-cell *matCellDef="let row; let element"
                        [ngClass]="{'col-value': element.details === undefined}">
                        <!-- expand caret -->
                        <span *ngIf="i === 0 && element.details">
                            <span (click)="toggleRow(element)"
                                *ngIf="expandedElement && expandedElement[cols] === element[cols]; else plusIcon"
                                class="expand-icon">&#9660;</span>
                            <ng-template #plusIcon><span (click)="toggleRow(element)" class="expand-icon">&#9658;</span>
                            </ng-template>
                        </span>
                        <span *ngIf="!(i === 0 && element.details)">
                            <span>{{element[cols]}}</span>
                        </span>
                    </mat-cell>
                </ng-container>

                <!-- Expanded Content Column - The detail row is made up of this one column -->
                <ng-container matColumnDef="expandedDetail">
                    <mat-cell *matCellDef="let detail">
                        <mat-table #table2 style="width: 100%" [dataSource]="detail.details" multiTemplateDataRows
                            matSort aria-label="Elements">
                            <ng-container [matColumnDef]="cols"
                                *ngFor="let cols of displayedDetailColumns; let i = index">
                                <mat-header-cell *matHeaderCellDef mat-sort-header>{{cols}}</mat-header-cell>
                                <mat-cell *matCellDef="let element">
                                    <span>{{element[cols]}}</span>
                                </mat-cell>
                            </ng-container>
                            <mat-header-row *matHeaderRowDef="displayedDetailColumns"></mat-header-row>
                            <mat-row *matRowDef="let row; columns: displayedDetailColumns;"></mat-row>
                        </mat-table>
                    </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;" [class.expanded]="expandedElement == row">
                </mat-row>
                <mat-row *matRowDef="let row; columns: ['expandedDetail']; "
                    [@detailExpand]="row == expandedElement ? 'expanded' : 'collapsed'" style="overflow: hidden">
                </mat-row>
            </mat-table>

            <mat-paginator #paginator *ngIf="dataSource.length > 0" [length]="totalRecords" [pageIndex]="0"
                [pageSize]="25" [pageSizeOptions]="[25, 50, 100, 250]">
            </mat-paginator>

            <p *ngIf="dataSource.length === 0">No records found</p>
        </mat-card>
    </div>
    <!-- / CONTENT -->

</div>

<!-- ADD CONTACT BUTTON -->
<button mat-fab color="warn" id="add-contact-button" (click)="newPrice()" aria-label="add contact"
        [@animate]="{value:'*', params:{delay:'300ms',scale:'.2'}}">
    <mat-icon>add</mat-icon>
</button>
<!-- / ADD CONTACT BUTTON -->